<!DOCTYPE html>

<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="js/bluebird.js"></script>
    <script>
        var waitIsOver = false;

        $(function () {
            $('#1').click(function () {
                waitIsOver = true;
                wait()
                .then(function () {
                    console.log('wait over in button click');
                    buttonClicked();
                });
            });
        
            $('#2').click(function () {
                waitIsOver = true;
            });
        });

        function buttonClicked () {
            //waitIsOver = false;
            wait()
            .then(function () {
                console.log('wait resolved and then invoked');
            });
        }


        function wait () {
            return new Promise(function (resolve, reject) {
                isOver();
                function isOver() {
                    if (waitIsOver) {
                        resolve();
                    } else {
                        setTimeout(isOver, 200);
                    }
                }
            });
        }

    </script>
</head>

<body>
    <button id="1">click me</button>
    <button id="2">wait is over</button>
</body>
</html>